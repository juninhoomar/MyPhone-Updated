(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[978],{347:(e,t,a)=>{Promise.resolve().then(a.bind(a,9682))},2657:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(9946).A)("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])},5896:(e,t,a)=>{"use strict";a.d(t,{R:()=>i});var s=a(2115);let r="quotes";function i(){let[e,t]=(0,s.useState)([]),[a,i]=(0,s.useState)(new Map);(0,s.useEffect)(()=>{let e=localStorage.getItem(r);e&&t(JSON.parse(e).map(e=>({...e,createdAt:new Date(e.createdAt),updatedAt:new Date(e.updatedAt),validUntil:new Date(e.validUntil)})))},[]),(0,s.useEffect)(()=>{e.length>0&&localStorage.setItem(r,JSON.stringify(e))},[e]);let n=e=>{i(t=>{let a=new Map(t);return a.delete(e),a})},l=()=>{i(new Map)};return{quotes:e,selectedProducts:a,addProductToQuote:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;i(a=>{let s=new Map(a),r=s.get(e.id)||0;return s.set(e.id,r+t),s})},removeProductFromQuote:n,updateProductQuantity:(e,t)=>{if(t<=0){n(e);return}i(a=>{let s=new Map(a);return s.set(e,t),s})},clearSelectedProducts:l,createQuote:(e,s)=>{let r=Array.from(a.entries()).map(e=>{let[t,a]=e,r=s.find(e=>e.id===t),i=r.promotionalPrice||r.price;return{product:r,quantity:a,unitPrice:i,totalPrice:i*a}}),i=r.reduce((e,t)=>e+t.totalPrice,0),n=new Date;n.setDate(n.getDate()+e.validDays);let o={id:"quote-".concat(Date.now()),customerName:e.customerName,customerEmail:e.customerEmail,customerPhone:e.customerPhone,items:r,subtotal:i,discount:0,total:i-0,status:"draft",createdAt:new Date,updatedAt:new Date,validUntil:n,notes:e.notes};return t(e=>[o,...e]),l(),o},updateQuoteStatus:(e,a)=>{t(t=>t.map(t=>t.id===e?{...t,status:a,updatedAt:new Date}:t))},deleteQuote:e=>{t(t=>t.filter(t=>t.id!==e))},getQuote:t=>e.find(e=>e.id===t)}}},8145:(e,t,a)=>{"use strict";a.d(t,{E:()=>l});var s=a(5155),r=a(2085),i=a(3999);let n=(0,r.F)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function l(e){let{className:t,variant:a,...r}=e;return(0,s.jsx)("div",{className:(0,i.cn)(n({variant:a}),t),...r})}},9474:(e,t,a)=>{"use strict";a.d(t,{T:()=>n});var s=a(5155),r=a(2115),i=a(3999);let n=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("textarea",{className:(0,i.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",a),ref:t,...r})});n.displayName="Textarea"},9682:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>D});var s=a(5155),r=a(2115),i=a(5896),n=a(1188),l=a(8482),o=a(7168),d=a(8145),c=a(9852),m=a(2714),u=a(9474),x=a(9840),h=a(5784),p=a(9946);let f=(0,p.A)("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]),g=(0,p.A)("ShoppingCart",[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]]);var j=a(4616),v=a(1788),b=a(2657),N=a(2525),y=a(6874),w=a.n(y);function D(){let{quotes:e,selectedProducts:t,createQuote:a,deleteQuote:p,updateQuoteStatus:y}=(0,i.R)(),{products:D}=(0,n.Q)(),[R,C]=(0,r.useState)(!1),[k,S]=(0,r.useState)({customerName:"",customerEmail:"",customerPhone:"",notes:"",validDays:30}),P=Array.from(t.entries()).map(e=>{let[t,a]=e,s=D.find(e=>e.id===t);return s?{product:s,quantity:a}:null}).filter(Boolean),E=P.reduce((e,t)=>t?e+(t.product.promotionalPrice||t.product.price)*t.quantity:e,0),A=async e=>{try{let t=await fetch("/api/generate-pdf",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({quoteId:e})});if(t.ok){let a=await t.blob(),s=window.URL.createObjectURL(a),r=document.createElement("a");r.style.display="none",r.href=s,r.download="orcamento-".concat(e,".pdf"),document.body.appendChild(r),r.click(),window.URL.revokeObjectURL(s)}}catch(e){console.error("Erro ao gerar PDF:",e),alert("Erro ao gerar PDF")}},z=e=>{switch(e){case"draft":default:return"bg-gray-100 text-gray-800";case"sent":return"bg-blue-100 text-blue-800";case"approved":return"bg-green-100 text-green-800";case"rejected":return"bg-red-100 text-red-800"}},F=e=>{switch(e){case"draft":return"Rascunho";case"sent":return"Enviado";case"approved":return"Aprovado";case"rejected":return"Rejeitado";default:return e}};return(0,s.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100",children:(0,s.jsxs)("div",{className:"container mx-auto px-4 py-8",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-8",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(f,{className:"w-8 h-8 text-blue-600"}),(0,s.jsx)("h1",{className:"text-3xl font-bold",children:"Or\xe7amentos"})]}),(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[(0,s.jsx)(w(),{href:"/catalog",children:(0,s.jsxs)(o.$,{variant:"outline",children:[(0,s.jsx)(g,{className:"w-4 h-4 mr-2"}),"Selecionar Produtos"]})}),(0,s.jsxs)(x.lG,{open:R,onOpenChange:C,children:[(0,s.jsx)(x.zM,{asChild:!0,children:(0,s.jsxs)(o.$,{disabled:0===t.size,children:[(0,s.jsx)(j.A,{className:"w-4 h-4 mr-2"}),"Criar Or\xe7amento"]})}),(0,s.jsxs)(x.Cf,{className:"sm:max-w-[500px]",children:[(0,s.jsxs)(x.c7,{children:[(0,s.jsx)(x.L3,{children:"Criar Novo Or\xe7amento"}),(0,s.jsx)(x.rr,{children:"Preencha os dados do cliente para gerar o or\xe7amento"})]}),(0,s.jsxs)("form",{onSubmit:e=>{if(e.preventDefault(),0===t.size){alert("Selecione pelo menos um produto para criar o or\xe7amento");return}let s=a(k,D);C(!1),S({customerName:"",customerEmail:"",customerPhone:"",notes:"",validDays:30}),A(s.id)},className:"space-y-4",children:[(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(m.J,{htmlFor:"customerName",children:"Nome do Cliente"}),(0,s.jsx)(c.p,{id:"customerName",value:k.customerName,onChange:e=>S(t=>({...t,customerName:e.target.value})),required:!0})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(m.J,{htmlFor:"customerEmail",children:"Email"}),(0,s.jsx)(c.p,{id:"customerEmail",type:"email",value:k.customerEmail,onChange:e=>S(t=>({...t,customerEmail:e.target.value})),required:!0})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(m.J,{htmlFor:"customerPhone",children:"Telefone"}),(0,s.jsx)(c.p,{id:"customerPhone",value:k.customerPhone,onChange:e=>S(t=>({...t,customerPhone:e.target.value})),required:!0})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(m.J,{htmlFor:"validDays",children:"V\xe1lido por (dias)"}),(0,s.jsxs)(h.l6,{value:k.validDays.toString(),onValueChange:e=>S(t=>({...t,validDays:Number.parseInt(e)})),children:[(0,s.jsx)(h.bq,{children:(0,s.jsx)(h.yv,{})}),(0,s.jsxs)(h.gC,{children:[(0,s.jsx)(h.eb,{value:"15",children:"15 dias"}),(0,s.jsx)(h.eb,{value:"30",children:"30 dias"}),(0,s.jsx)(h.eb,{value:"60",children:"60 dias"}),(0,s.jsx)(h.eb,{value:"90",children:"90 dias"})]})]})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(m.J,{htmlFor:"notes",children:"Observa\xe7\xf5es"}),(0,s.jsx)(u.T,{id:"notes",value:k.notes,onChange:e=>S(t=>({...t,notes:e.target.value})),placeholder:"Observa\xe7\xf5es adicionais..."})]}),(0,s.jsxs)("div",{className:"border-t pt-4",children:[(0,s.jsx)("h4",{className:"font-semibold mb-2",children:"Produtos Selecionados:"}),(0,s.jsx)("div",{className:"space-y-2 max-h-32 overflow-y-auto",children:P.map(e=>{if(!e)return null;let t=e.product.promotionalPrice||e.product.price;return(0,s.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,s.jsxs)("span",{children:[e.product.name," x",e.quantity]}),(0,s.jsxs)("span",{children:["R$ ",(t*e.quantity).toLocaleString("pt-BR",{minimumFractionDigits:2})]})]},e.product.id)})}),(0,s.jsxs)("div",{className:"border-t mt-2 pt-2 font-semibold",children:["Total: R$ ",E.toLocaleString("pt-BR",{minimumFractionDigits:2})]})]}),(0,s.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,s.jsx)(o.$,{type:"button",variant:"outline",onClick:()=>C(!1),children:"Cancelar"}),(0,s.jsx)(o.$,{type:"submit",children:"Criar Or\xe7amento"})]})]})]})]})]})]}),t.size>0&&(0,s.jsxs)(l.Zp,{className:"mb-8",children:[(0,s.jsxs)(l.aR,{children:[(0,s.jsxs)(l.ZB,{children:["Produtos Selecionados (",t.size,")"]}),(0,s.jsxs)(l.BT,{children:["Total: R$ ",E.toLocaleString("pt-BR",{minimumFractionDigits:2})]})]}),(0,s.jsx)(l.Wu,{children:(0,s.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:P.map(e=>{if(!e)return null;let t=e.product.promotionalPrice||e.product.price;return(0,s.jsxs)("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h4",{className:"font-medium",children:e.product.name}),(0,s.jsxs)("p",{className:"text-sm text-muted-foreground",children:[e.quantity,"x R$ ",t.toLocaleString("pt-BR",{minimumFractionDigits:2})]})]}),(0,s.jsx)("div",{className:"text-right",children:(0,s.jsxs)("p",{className:"font-semibold",children:["R$ ",(t*e.quantity).toLocaleString("pt-BR",{minimumFractionDigits:2})]})})]},e.product.id)})})})]}),(0,s.jsx)("div",{className:"grid grid-cols-1 gap-6",children:0===e.length?(0,s.jsxs)("div",{className:"text-center py-12",children:[(0,s.jsx)(f,{className:"w-16 h-16 text-muted-foreground mx-auto mb-4"}),(0,s.jsx)("h3",{className:"text-xl font-semibold mb-2",children:"Nenhum or\xe7amento criado"}),(0,s.jsx)("p",{className:"text-muted-foreground mb-4",children:"Selecione produtos no cat\xe1logo e crie seu primeiro or\xe7amento."}),(0,s.jsx)(w(),{href:"/catalog",children:(0,s.jsxs)(o.$,{children:[(0,s.jsx)(g,{className:"w-4 h-4 mr-2"}),"Ir para Cat\xe1logo"]})})]}):e.map(e=>(0,s.jsxs)(l.Zp,{children:[(0,s.jsx)(l.aR,{children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)(l.ZB,{className:"flex items-center gap-2",children:[e.customerName,(0,s.jsx)(d.E,{className:z(e.status),children:F(e.status)})]}),(0,s.jsxs)(l.BT,{children:[e.customerEmail," • ",e.customerPhone]})]}),(0,s.jsxs)("div",{className:"text-right",children:[(0,s.jsxs)("p",{className:"text-2xl font-bold text-primary",children:["R$ ",e.total.toLocaleString("pt-BR",{minimumFractionDigits:2})]}),(0,s.jsxs)("p",{className:"text-sm text-muted-foreground",children:[e.items.length," ",1===e.items.length?"item":"itens"]})]})]})}),(0,s.jsx)(l.Wu,{children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"text-sm text-muted-foreground",children:[(0,s.jsxs)("p",{children:["Criado em: ",e.createdAt.toLocaleDateString("pt-BR")]}),(0,s.jsxs)("p",{children:["V\xe1lido at\xe9: ",e.validUntil.toLocaleDateString("pt-BR")]})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsxs)(o.$,{variant:"outline",size:"sm",onClick:()=>A(e.id),children:[(0,s.jsx)(v.A,{className:"w-4 h-4 mr-2"}),"PDF"]}),(0,s.jsx)(w(),{href:"/quotes/".concat(e.id),children:(0,s.jsxs)(o.$,{variant:"outline",size:"sm",children:[(0,s.jsx)(b.A,{className:"w-4 h-4 mr-2"}),"Ver"]})}),(0,s.jsx)(o.$,{variant:"outline",size:"sm",onClick:()=>p(e.id),className:"text-red-600 hover:text-red-700",children:(0,s.jsx)(N.A,{className:"w-4 h-4"})})]})]})})]},e.id))})]})})}},9840:(e,t,a)=>{"use strict";a.d(t,{Cf:()=>u,L3:()=>h,c7:()=>x,lG:()=>o,rr:()=>p,zM:()=>d});var s=a(5155),r=a(2115),i=a(5452),n=a(4416),l=a(3999);let o=i.bL,d=i.l9,c=i.ZL;i.bm;let m=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(i.hJ,{ref:t,className:(0,l.cn)("fixed inset-0 z-50 bg-background/80 backdrop-blur-sm data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",a),...r})});m.displayName=i.hJ.displayName;let u=r.forwardRef((e,t)=>{let{className:a,children:r,...o}=e;return(0,s.jsxs)(c,{children:[(0,s.jsx)(m,{}),(0,s.jsxs)(i.UC,{ref:t,className:(0,l.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",a),...o,children:[r,(0,s.jsxs)(i.bm,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,s.jsx)(n.A,{className:"h-4 w-4"}),(0,s.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});u.displayName=i.UC.displayName;let x=e=>{let{className:t,...a}=e;return(0,s.jsx)("div",{className:(0,l.cn)("flex flex-col space-y-1.5 text-center sm:text-left",t),...a})};x.displayName="DialogHeader";let h=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(i.hE,{ref:t,className:(0,l.cn)("text-lg font-semibold leading-none tracking-tight",a),...r})});h.displayName=i.hE.displayName;let p=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(i.VY,{ref:t,className:(0,l.cn)("text-sm text-muted-foreground",a),...r})});p.displayName=i.VY.displayName}},e=>{var t=t=>e(e.s=t);e.O(0,[874,605,747,359,441,684,358],()=>t(347)),_N_E=e.O()}]);